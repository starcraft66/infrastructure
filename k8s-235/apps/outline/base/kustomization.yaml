apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ./resources/namespace.yaml
- ./resources/statefulset.yaml
- ./resources/service.yaml
- ./resources/volume.yaml

namespace: outline

# Photoprism only supports MariaDB and there's no good Operator for it
helmCharts:
- name: minio
  includeCRDs: true
  releaseName: outline
  version: 12.1.8
  repo: https://charts.bitnami.com/bitnami
  namespace: outline
  valuesInline:
    mode: standalone
    auth:
      existingSecret: minio-secrets
    metrics:
      enabled: true
      serviceMonitor:
        enabled: true
      prometheusRule:
        enabled: true
    persistence:
      storageClass: "freenas-nfs-csi"
- name: redis
  releaseName: outline
  version: 17.0.8
  repo: https://charts.bitnami.com/bitnami
  namespace: outline
  valuesInline:
    auth:
      existingSecret: outline-redis
    global:
      storageClass: "freenas-nfs-csi"