apiVersion: "acid.zalan.do/v1"
kind: postgresql
metadata:
  name: funkwhale-postgres
  namespace: postgres-operator
spec:
  teamId: "funkwhale"
  volume:
    size: 10Gi
    storageClass: "freenas-nfs-csi"
  numberOfInstances: 2
  users:
    root:  # database owner
    - superuser
    - createdb
  preparedDatabases:
    funkwhale:
      defaultUsers: true
      extensions:
        unaccent: data
        citext: data
  postgresql:
    version: "14"
---
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: cluster-example-initdb
spec:
  instances: 1
  bootstrap:
    initdb:
      database: funkwhale
      owner: funkwhale
      postInitSQL:
        - CREATE EXTENSION citext;
        - CREATE EXTENSION unaccent;
      secret:
        name: postgres
  storage:
    storageClass: truenas-nfs-spitfire-fast
    size: 10Gi