apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../../base

namespace: democratic-csi

generators:
- ./generators/secrets-generator.yaml

images:
- name: k8s.gcr.io/sig-storage/csi-provisioner
  newTag: v2.2.2
- name: k8s.gcr.io/sig-storage/csi-resizer
  newTag: v1.3.0
- name: k8s.gcr.io/sig-storage/csi-snapshotter
  newTag: v4.1.1
- name: democraticcsi/democratic-csi
  newTag: latest
- name: k8s.gcr.io/sig-storage/csi-node-driver-registrar
  newTag: v2.2.0
- name: democraticcsi/democratic-csi
  newTag: latest

commonLabels:
  app.kubernetes.io/name: democratic-csi

patchesJson6902:
- path: ./patches/leader-election-namespace.yaml
  target:
    group: apps
    kind: Deployment
    name: zfs-nfs-democratic-csi-controller
    version: v1
- path: ./patches/leader-election-namespace.yaml
  target:
    group: apps
    kind: Deployment
    name: zfs-nfs-spitfire-fast-democratic-csi-controller
    version: v1
- path: ./patches/leader-election-namespace.yaml
  target:
    group: apps
    kind: Deployment
    name: zfs-iscsi-democratic-csi-controller
    version: v1
